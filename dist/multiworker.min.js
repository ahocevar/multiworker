!function t(e,n,r){function i(o,a){if(!n[o]){if(!e[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var h=n[o]={exports:{}};e[o][0].call(h.exports,function(t){var n=e[o][1][t];return i(n?n:t)},h,h.exports,t,e,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=0,s=function o(){r(this,o),this.id=i++,this.done=!1};e.exports=s},{}],2:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function s(t,e,n){r(this,s),this.event=n,this.done=!!e.done,this.instance=t};e.exports=i},{}],3:[function(t,e,n){"use strict";window.MultiWorker=t("./index")},{"./index":4}],4:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./util"),o=t("./Post"),a=t("./WorkerMessage"),u=t("./workerString"),c=new WeakMap,h=function(){function t(e){var n=this;r(this,t);var i=void 0!==e.worker?e.worker:e;"string"==typeof i?s.get(i,function(t){n.worker=t,n._init()}):"function"==typeof i&&(this.worker=s.functionToInstantString(i)),this.callback=e.callback||s.noop,this.threads=e.threads||1,this.dependencies=e.dependencies||[],this._initProperties(),this.worker&&this._init()}return i(t,[{key:"post",value:function(){var t=Array.prototype.slice.call(arguments),e="function"==typeof t[t.length-1]?t.pop():this.callback;return this._process(t,e),this}},{key:"terminate",value:function(){var t=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],e=arguments[1];return"function"==typeof t&&(e=t,t=!1),t||this.ready&&!this.processCount?(this.workerList.forEach(function(t){return t.terminate()}),this._initProperties(),this.threads=0,delete this.terminateWhenFree,"function"==typeof e&&e()):this.terminateWhenFree=e||!0,this}},{key:"_init",value:function(){this.ready=!0,this._initThreads(),this._processQueue()}},{key:"_process",value:function(t,e){var n=this._availableWorker,r=new o;t.push(r),this.ready&&n?(this._inProgressData[r.id]={cb:e,worker:n},n.postMessage(t),c.set(n,!0),this.processCount++):this.queue.push([t,e])}},{key:"_initProperties",value:function(){this.ready=!1,this.workerList=[],this.queue=[],this.processCount=0,this._inProgressData={}}},{key:"_initThreads",value:function(){for(var t=this.threads;t--;){var e=new Worker(this._blobUrl);e.addEventListener("message",this.constructor._defaultMessageEvent.bind(this),!1),this.workerList.push(e)}}},{key:"_processFinished",value:function(t){this.processCount--;var e=this._inProgressData[t].worker;return c.set(e,!1),delete this._inProgressData[t],this}},{key:"_processQueue",value:function(){if(this.queue.length&&this.processCount<this.threads){var t=this.queue.shift();this._process.apply(this,t),this._processQueue()}else this.terminateWhenFree&&!this.processCount&&this.terminate(!0,this.terminateWhenFree);return this}},{key:"_availableWorker",get:function(){for(var t=this.workerList,e=0,n=t.length;n>e;e++)if(!c.get(t[e]))return t[e];return!1}},{key:"_workerString",get:function(){return u.replace("'__MultiWorker_placeholder__';",this._dependencyString+this.worker)}},{key:"_blobUrl",get:function(){return this._blobUrlCached||(this._blobUrlCached=window.URL.createObjectURL(new Blob([this._workerString],{type:"application/javascript"}))),this._blobUrlCached}},{key:"_dependencyString",get:function(){return s.stringifyFunctionList(this.dependencies)}}],[{key:"_defaultMessageEvent",value:function(t){var e=t.data.pop(),n=this._inProgressData[e.id].cb,r=new a(this,e,t);e.done&&this._processFinished(e.id),n.apply(r,t.data),e.done&&this._processQueue()}}]),t}();e.exports=h},{"./Post":1,"./WorkerMessage":2,"./util":5,"./workerString":6}],5:[function(t,e,n){"use strict";function r(t){return"("+t.toString()+")();"}function i(t){return t.reduce(function(t,e){return t+e.toString()+";"},"")}function s(){}function o(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&200===n.status&&e(n.responseText)},n.open("GET",t,!0),n.send()}Object.defineProperty(n,"__esModule",{value:!0}),n.functionToInstantString=r,n.stringifyFunctionList=i,n.noop=s,n.get=o},{}],6:[function(t,e,n){"use strict";var r=t("./util");e.exports=r.functionToInstantString(function(){!function(){function t(){var t=Array.prototype.slice.call(arguments);e.done=t.shift(),t.push(e),postMessage(t)}var e=void 0;self["return"]=t.bind(this,!0),self.post=t.bind(this,!1),self.addEventListener("message",function(t){e=t.data.pop(),self.receive.apply(t,t.data)},!1)}()})},{"./util":5}]},{},[3]);